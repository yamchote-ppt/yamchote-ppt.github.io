\documentclass[12pt,twoside,openright]{book}

% Add styles directory to search path
\makeatletter
\def\input@path{{styles/}}
\makeatother

\def\TextOrHandout{text}
%\def\TextOrHandout{handout}

\usepackage{amssymb,amsmath,amsthm,graphicx,mathrsfs}
\usepackage{fontspec}
\usepackage{polyglossia}
\setdefaultlanguage{english}
\setotherlanguage{thai} 

% ===============================
% PRESS TRIM SIZE AND MARGINS (190 x 260 mm)
% Same as latex_text for consistent book series
% ===============================
\usepackage{geometry}
\geometry{
	paperwidth=190mm,
	paperheight=260mm,
	inner=24mm,
	outer=18mm,
	top=20mm,
	bottom=20mm,
	bindingoffset=6mm,
	includeheadfoot,
	heightrounded
} 
\usepackage{tikz} 
\usepackage{xcolor}
\usepackage{amsrefs}
\usepackage[bookmarks]{hyperref}
\usepackage{lipsum}  
\usepackage{forloop}
\usepackage{ifthen}
\usepackage[most]{tcolorbox}
\usepackage{pygmentex}
\tcbuselibrary{minted}
%\usepackage{minted2}
\usepackage{minted}
\usepackage{setspace}
\onehalfspacing
\tcbuselibrary{theorems}
\usetikzlibrary{shapes.geometric}
\usepackage{enumitem}
\setlist[enumerate]{itemsep=0mm}

\usepackage{imakeidx}
\makeindex

% ===============================
% Font configuration: Libertinus Serif for English, TH Sarabun for Thai
% Using manual font switching for reliable Thai text display
% ===============================

% Main font for English: Libertinus Serif
\setmainfont{LibertinusSerif}[
Extension=.otf,
Path=./styles/,
UprightFont=*-Regular,
BoldFont=*-Bold,
ItalicFont=*-Italic,
BoldItalicFont=*-BoldItalic,
Ligatures=TeX,
Scale=1.0
]

% Thai font: TH Sarabun (scaled to match Libertinus Serif x-height)
\newfontfamily\thaifont{THSarabun.ttf}[
Scale=1.2,
Path=./styles/,
Script=Thai,
UprightFont = *,
BoldFont    = * Bold,
ItalicFont  = * Italic,
BoldItalicFont = * Bold Italic
]

% Set up Thai language support
\newfontfamily\thaifonttt{THSarabun.ttf}[Scale=1.2, Path=./styles/]
\newfontfamily\thaifontsf{THSarabun.ttf}[Scale=1.2, Path=./styles/]

\XeTeXlinebreaklocale "th"
\XeTeXlinebreakskip = 0pt plus 1pt

% Auto-switch to Thai font for Thai characters using XeTeX interchar classes
\XeTeXinterchartokenstate=1
\newXeTeXintercharclass\thaichars

% Register Thai consonants
\XeTeXcharclass`ก=\thaichars \XeTeXcharclass`ข=\thaichars \XeTeXcharclass`ฃ=\thaichars \XeTeXcharclass`ค=\thaichars
\XeTeXcharclass`ฅ=\thaichars \XeTeXcharclass`ฆ=\thaichars \XeTeXcharclass`ง=\thaichars \XeTeXcharclass`จ=\thaichars
\XeTeXcharclass`ฉ=\thaichars \XeTeXcharclass`ช=\thaichars \XeTeXcharclass`ซ=\thaichars \XeTeXcharclass`ฌ=\thaichars
\XeTeXcharclass`ญ=\thaichars \XeTeXcharclass`ฎ=\thaichars \XeTeXcharclass`ฏ=\thaichars \XeTeXcharclass`ฐ=\thaichars
\XeTeXcharclass`ฑ=\thaichars \XeTeXcharclass`ฒ=\thaichars \XeTeXcharclass`ณ=\thaichars \XeTeXcharclass`ด=\thaichars
\XeTeXcharclass`ต=\thaichars \XeTeXcharclass`ถ=\thaichars \XeTeXcharclass`ท=\thaichars \XeTeXcharclass`ธ=\thaichars
\XeTeXcharclass`น=\thaichars \XeTeXcharclass`บ=\thaichars \XeTeXcharclass`ป=\thaichars \XeTeXcharclass`ผ=\thaichars
\XeTeXcharclass`ฝ=\thaichars \XeTeXcharclass`พ=\thaichars \XeTeXcharclass`ฟ=\thaichars \XeTeXcharclass`ภ=\thaichars
\XeTeXcharclass`ม=\thaichars \XeTeXcharclass`ย=\thaichars \XeTeXcharclass`ร=\thaichars \XeTeXcharclass`ฤ=\thaichars
\XeTeXcharclass`ล=\thaichars \XeTeXcharclass`ฦ=\thaichars \XeTeXcharclass`ว=\thaichars \XeTeXcharclass`ศ=\thaichars
\XeTeXcharclass`ษ=\thaichars \XeTeXcharclass`ส=\thaichars \XeTeXcharclass`ห=\thaichars \XeTeXcharclass`ฬ=\thaichars
\XeTeXcharclass`อ=\thaichars \XeTeXcharclass`ฮ=\thaichars

% Register Thai vowels and tone marks
\XeTeXcharclass`ะ=\thaichars \XeTeXcharclass`ั=\thaichars \XeTeXcharclass`า=\thaichars \XeTeXcharclass`ำ=\thaichars
\XeTeXcharclass`ิ=\thaichars \XeTeXcharclass`ี=\thaichars \XeTeXcharclass`ึ=\thaichars \XeTeXcharclass`ื=\thaichars
\XeTeXcharclass`ุ=\thaichars \XeTeXcharclass`ู=\thaichars \XeTeXcharclass`ฺ=\thaichars
\XeTeXcharclass`เ=\thaichars \XeTeXcharclass`แ=\thaichars \XeTeXcharclass`โ=\thaichars \XeTeXcharclass`ใ=\thaichars
\XeTeXcharclass`ไ=\thaichars \XeTeXcharclass`ๅ=\thaichars \XeTeXcharclass`ๆ=\thaichars
\XeTeXcharclass`็=\thaichars \XeTeXcharclass`่=\thaichars \XeTeXcharclass`้=\thaichars \XeTeXcharclass`๊=\thaichars
\XeTeXcharclass`๋=\thaichars \XeTeXcharclass`์=\thaichars \XeTeXcharclass`ํ=\thaichars \XeTeXcharclass`ฯ=\thaichars

% Register Thai numbers
\XeTeXcharclass`๐=\thaichars \XeTeXcharclass`๑=\thaichars \XeTeXcharclass`๒=\thaichars \XeTeXcharclass`๓=\thaichars
\XeTeXcharclass`๔=\thaichars \XeTeXcharclass`๕=\thaichars \XeTeXcharclass`๖=\thaichars \XeTeXcharclass`๗=\thaichars
\XeTeXcharclass`๘=\thaichars \XeTeXcharclass`๙=\thaichars

% Switch to Thai font when Thai characters are encountered
\XeTeXinterchartoks 0 \thaichars = {\begingroup\thaifont}
\XeTeXinterchartoks 255 \thaichars = {\begingroup\thaifont}
\XeTeXinterchartoks \thaichars 0 = {\endgroup}
\XeTeXinterchartoks \thaichars 255 = {\endgroup}

\title{คณิตศาสตร์ดีสครีตสำหรับการเขียนโปรแกรม\\(Discrete Mathematics for Programming)}
\author{Phaphontee Yamchote}
\date{}

%\newtheorem{thm}{Theorem}
%\newtheorem{prop}{Proposition}
%\newtheorem{lem}{Lemma}

\theoremstyle{definition}
\newtheorem{defin}{Definition}[section]
\newtheorem{exam}[defin]{Example}
\newtheorem{exer}[defin]{Exercise}

\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}


\newcommand{\boxrule}[2]{
		{~\newline~\newline\centering
		\begin{tikzpicture}
			\node[anchor=text,text width=\columnwidth-0.5cm, draw, rounded corners, line width=1pt, fill=gray!10, inner sep=3mm] (big) {\newline#2};
			\node[draw, rounded corners, line width=.5pt, fill=yellow!40, anchor=west, xshift=2.5mm] (small) at (big.north west) {\textbf{#1}};
		\end{tikzpicture}}
}

\newcommand{\boxnote}[2]{
	{~\newline~\newline\centering
		\begin{tikzpicture}
			\node[anchor=text,text width=\columnwidth-0.5cm, draw, rounded corners, line width=0.5pt, fill=white, inner sep=3mm] (big) {\\#2};
			\node[draw, rounded corners, line width=.5pt, fill=gray!40, anchor=west, xshift=2.5mm] (small) at (big.north west) {#1};
	\end{tikzpicture}}
}

\newcommand{\solution}[1]{
	\ifthenelse{\equal{\TextOrHandout}{handout}}{\vspace{5 cm}}{\paragraph{Solution.} #1~\newline}
}

\definecolor{bg}{rgb}{0.95,0.95,0.95}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%										   %%%
%%             Python code				   %%%
%%										   %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tcbset{
	pythoncodebox/.style={
		enhanced jigsaw,breakable,
		colback=gray!10,colframe=gray!20!black,
		boxrule=1pt,top=2pt,bottom=2pt,left=2pt,right=2pt,
		sharp corners,before skip=10pt,after skip=10pt,
		attach boxed title to top left,
		boxed title style={empty,
			top=0pt,bottom=0pt,left=2pt,right=2pt,
			interior code={\fill[fill=tcbcolframe] (frame.south west)
				--([yshift=-4pt]frame.north west)
				to[out=90,in=180] ([xshift=4pt]frame.north west)
				--([xshift=-8pt]frame.north east)
				to[out=0,in=180] ([xshift=16pt]frame.south east)
				--cycle;
			}
		},
		title={#1}, % Argument of pythoncodebox specifies the title
		fonttitle=\sffamily\bfseries
	},
	pythoncodebox/.default={}, % Default is No title
	%%% Starred version has no frame %%%
	pythoncodebox*/.style={
		enhanced jigsaw,breakable,
		colback=gray!10,coltitle=gray!20!black,colbacktitle=tcbcolback,
		frame hidden,
		top=2pt,bottom=2pt,left=2pt,right=2pt,
		sharp corners,before skip=10pt,after skip=10pt,
		attach boxed title to top text left={yshift=-1mm},
		boxed title style={empty,
			top=0pt,bottom=0pt,left=2pt,right=2pt,
			interior code={\fill[fill=tcbcolback] (interior.south west)
				--([yshift=-4pt]interior.north west)
				to[out=90,in=180] ([xshift=4pt]interior.north west)
				--([xshift=-8pt]interior.north east)
				to[out=0,in=180] ([xshift=16pt]interior.south east)
				--cycle;
			}
		},
		title={#1}, % Argument of pythoncodebox specifies the title
		fonttitle=\sffamily\bfseries
	},
	pythoncodebox*/.default={}, % Default is No title
}
% Custom tcolorbox for Python code (not the code itself, just the box it appears in)
\newtcolorbox{pythonbox}[1][]{pythoncodebox=#1}
\newtcolorbox{pythonbox*}[1][]{pythoncodebox*=#1} % Starred version has no frame

% Custom minted environment for Python code, NOT using tcolorbox
\newminted{python}{autogobble,breaklines,mathescape}

% Custom tcblisting environment for Python code, using the "minted" tcb listing engine
% Adapted from https://tex.stackexchange.com/a/402096
\NewTCBListing{python}{ !O{} !D(){} !G{} }{
	listing engine=minted,
	listing only,
	pythoncodebox={#1}, % First argument specifies the title (if any)
	minted language=python,
	minted options/.expanded={
		autogobble,breaklines,mathescape,
		#2 % Second argument, delimited by (), denotes options for the minted environment
	},
	#3 % Third argument, delimited by {}, denotes options for the tcolorbox
}

%%% Starred version has no frame %%%
\NewTCBListing{python*}{ !O{} !D(){} !G{} }{
	listing engine=minted,
	listing only,
	pythoncodebox*={#1}, % First argument specifies the title (if any)
	minted language=python,
	minted options/.expanded={
		autogobble,breaklines,mathescape,
		#2 % Second argument, delimited by (), denotes options for the minted environment
	},
	#3 % Third argument, delimited by {}, denotes options for the tcolorbox
}

% verbbox environment, for showing verbatim text next to code output (for package documentation and user learning purposes)
\NewTCBListing{verbbox}{ !O{} }{
	listing engine=minted,
	minted language=latex,
	boxrule=1pt,sidebyside,skin=bicolor,
	colback=gray!10,colbacklower=white,valign=center,
	top=2pt,bottom=2pt,left=2pt,right=2pt,
	#1
} % Last argument allows more tcolorbox options to be added
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%										   %%%
%%            end of Python code		   %%%
%%		 								   %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tcbuselibrary{theorems}

\newtcbtheorem[use counter*=defin,number within=section]{defn}{นิยาม~}%
{colback=yellow!0,colframe=black,fonttitle=\bfseries,colbacktitle=white,coltitle=black}{}
%
\newtcbtheorem[use counter*=defin,number within=section]{lem}{บทตั้ง}%
{colback=yellow!0,colframe=black,fonttitle=\bfseries}{}

\newtcbtheorem[use counter*=defin,number within=section]{prop}{คุณสมบัติ}%
{colback=yellow!0,colframe=black,fonttitle=\bfseries}{}

\newtcbtheorem[use counter*=defin,number within=section]{thm}{ทฤษฎีบท}%
{colback=yellow!0,colframe=black,fonttitle=\bfseries}{}

\newcommand{\progpart}{
	\begin{center}
		\title{\sffamily\colorbox{black}{\bfseries\textcolor{white}{\Large PROGRAMMING PART}}}
	\end{center}
}

\newcommand{\theopart}{
	\begin{center}
		\title{\sffamily\colorbox{black}{\bfseries\textcolor{white}{\Large THEORY PART}}}
	\end{center}
}

\newcommand{\proofpart}{
	\begin{center}
		\title{\sffamily\colorbox{black}{\bfseries\textcolor{white}{\Large PROOF PART}}}
	\end{center}
}

\renewenvironment{proof}{~\newline~\textbf{บทพิสูจน์}.}{$\square$}

\begin{document}
	\maketitle
	\frontmatter
	\tableofcontents

	\mainmatter

    \part{Basic Programming by Python}
    \include{chapters/chapter1-basic-prob-solv}
    \include{chapters/chapter2-syntax}
%    
   	\part{Basic Mathematical Reasoning and Proving}
   	\include{chapters/chapter3-mathLang}
   	\include{chapters/chapter4-basicObject}
   	\include{chapters/chapter5-logic-and-Reason}
   	\include{chapters/Recursion-prologue}
%%%%%% คิดว่าควรเอา method of proof ไปไว้ในบท logic and reasoning
%%   	\include{chapters/chapter6-method-proof}
%   	
%   	
   	\part{Discrete Mathematics with Programming}
   	\include{chapters/SetTheo}
   	\include{chapters/NumberTheo}
   	\include{chapters/NumberTheo_proof}
   	\include{chapters/NumberTheo_prog}
   	\include{chapters/Combinatoric}
   	\include{chapters/Combinatoric_prog}
   	\include{chapters/Recursion}
   	\include{chapters/graphTheo}
%   	\include{Automata}
	
	
	\backmatter
%	\include{chapters/solution}
	\printindex



\end{document}